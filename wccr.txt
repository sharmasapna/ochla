clea
CLOS ALL
SET SAFE OFF
SET TALK OFF
 D1="08-02-13"
 D2="08-02-13"
T="        "

@5,13 say "ENTER FROM DATE   " get D1
@7,13 say "ENTER TO DATE     " get D2
@9,13 SAY "ENTER DAY OR NIGHT" GET T
READ

use ms2

*BROW
zap

*appe from D:\XTALK\ABC\OCHHST for date>=D1.and.date<=D2.AND."20 H"$TIME.AND.("I"$LEVEL.OR."PRNTD"$LEVEL.OR."L "$LEVEL)
IF T="NIGHT" .OR. T="night"
*appe from D:\XTALK\ABC\JANTMP for DATE>=D1 .and. DATE<=D2 .AND. "20 H"$TIME
APPE FROM D:\XTALK\OCHLA\OHHST FOR DATE>=D1 .AND. DATE<=D2 .AND. "12 H"$TIME
*appe from D:\XTALK\ABC\juntmp 
BROW
ELSE
*appe from D:\XTALK\OCHLA\OCHHST for date>=D1.and.date<=D2 .AND."12 H"$TIME
ENDIF
REPL ALL STATION WITH "BPLCITY " FOR "T01"$NFSC
REPL ALL STATION WITH "BPLCITY " FOR "T06"$NFSC
REPL ALL STATION WITH "BHOPALSSA " FOR "SSA BPL"$LEVEL
         *REPL ALL STATION WITH "OCB LOCAL" FOR "OCB"$STATION
         *REPL ALL STATION WITH "R.S.N.EWSD" FOR "R.S.N.EWSD"$STATION
         *REPL ALL STATION WITH "GOVINDPURA" FOR "GOVINDPURA"$STATION
         *REPL ALL STATION WITH "CDOT" FOR "C DOT"$STATION.OR."CDOT"$STATION
         *REPL ALL STATION WITH "CTX E10B" FOR "CTX "$STATION
         *REPL ALL STATION WITH "ATX EWSD" FOR "ATX "$STATION
        
REPL ALL STATION WITH "REWA" FOR "REWA"$STATION

REPL ALL STATION WITH "GWALIOR" FOR "GWALIOR"$STATION
REPL ALL STATION WITH "CHINDWARA" FOR "CHINDWARA"$STATION
REPL ALL STATION WITH "GUNA" FOR "GUNA"$STATION
REPL ALL STATION WITH "INDORE TAX" FOR ("INDORE TAX"$STATION.OR."INDORE TAX ISD"$STATION.OR."INDORE TAX KISAN"$STATION)
REPL ALL STATION WITH "ITARSI" FOR ("ITAR"$STATION.OR."HOSHANGABAD"$STATION)
REPL ALL STATION WITH "SIDHI" FOR ("SIDHI"$STATION.OR."SINGROLI"$STATION)
REPL ALL STATION WITH "RAISEN" FOR ("RAISEN"$STATION.OR."OBEDULLAGANJ"$STATION)
REPL ALL STATION WITH "CHHATARPUR" FOR ("CHHATARPUR"$STATION.OR."TIKAMGARH"$STATION)
REPL ALL STATION WITH "MANDSAUR" FOR "MANDSAUR"$STATION
REPL ALL STATION WITH "RATLAM" FOR "RATLAM"$STATION
REPL ALL STATION WITH "NARSINGHPUR" FOR "NARSINGHPUR"$STATION
REPL ALL STATION WITH "SHAJAPUR" FOR "SHAJAPUR"$STATION
REPL ALL STATION WITH "BALAGHAT" FOR "BALAGHAT"$STATION.OR."BALAGHAT ISD"$STATION
REPL ALL STATION WITH "MANDLA" FOR "MANDLA"$STATION.OR."MANDLA ISD"$STATION
REPL ALL STATION WITH "BETUL" FOR "BETUL"$STATION
REPL ALL STATION WITH "CHHATARPUR" FOR ("CHHATARPUR"$STATION.OR."TIKAMGARH"$STATION)
REPL ALL STATION WITH "DAMOH" FOR "DAMOH"$STATION
REPL ALL STATION WITH "DHAR" FOR "DHAR"$SUBSTR(STATION,1,4)
REPL ALL STATION WITH "JABALPUR TAX" FOR ("JABALPUR TAX"$STATION.OR."JABALPUR TAX ISD"$STATION)
REPL ALL STATION WITH "JHABUA" FOR "JHABUA"$STATION
REPL ALL STATION WITH "KHANDWA" FOR "KHANDWA"$STATION
REPL ALL STATION WITH "KHARGONE" FOR "KHARGONE"$STATION
REPL ALL STATION WITH "MORENA" FOR "MORENA"$STATION.OR."BHIND"$STATION
REPL ALL STATION WITH "BIAORA" FOR "BIAORA"$STATION
REPL ALL STATION WITH "PANNA" FOR "PANNA"$STATION

REPL ALL STATION WITH "SAGAR" FOR "SAGAR"$STATION
REPL ALL STATION WITH "SATNA" FOR "SATNA"$STATION
REPL ALL STATION WITH "SEONI" FOR "SEONI"$STATION
REPL ALL STATION WITH "SHAHDOL" FOR "SHAHDOL"$STATION
REPL ALL STATION WITH "SHIVPURI" FOR "SHIVPURI"$STATION
REPL ALL STATION WITH "SHIVPURI" FOR "BSHIV"$NFSC

REPL ALL STATION WITH "UJJAIN" FOR "UJJAIN"$STATION
REPL ALL STATION WITH "VIDISHA" FOR "VIDISHA"$STATION
REPL ALL STATION WITH "OCB LOCAL" FOR "OCB LOCAL"$STATION
REPL ALL STATION WITH "CTX E10B" FOR "CTX"$STATION
REPL ALL STATION WITH "SEONI" FOR "SEONI"$STATION
REPL ALL STATION WITH "BALIA" FOR "BALIA"$STATION
REPL ALL STATION WITH "MIRJAPUR" FOR "MIRJAPUR"$STATION
REPL ALL STATION WITH "RIL WLL" FOR "RIL WLL"$STATION
REPL ALL STATION WITH "RIL W/LINE" FOR "RIL W/LINE"$STATION
REPL ALL STATION WITH "BTNL" FOR "BHARTHI"$STATION
REPL ALL STATION WITH "CTX E10B" FOR "CTX "$STATION
REPL ALL STATION WITH "TATA BASIC" FOR ("TATA BASIC"$STATION.OR."TATA T.S.(ISD)"$STATION)
REPL ALL STATION WITH "TATA T.S." FOR ("TATA T.S. "$STATION.OR."TATA.T.S "$STATION)
REPL ALL STATION WITH "RELIANCE" FOR ("RELIANCE      "$STATION.OR."RELIANCE LOC_PC"$STATION)
REPL ALL STATION WITH "RELIANCE UASP" FOR ("RELIANCE UASP"$STATION.OR."RELIANCE UASP LOC"$STATION.OR."RELIANCE UASPISD"$STATION)
REPL ALL STATION WITH "RPG" FOR ("RPG ISD"$STATION.OR."RPG LOC_PC"$STATION)

REPL ALL STATION WITH "ALCATEL MSC I" FOR "ALCATEL MSC   "$STATION
REPL ALL STATION WITH "ALCATEL MSC II" FOR "CITY ALCATEL MSC"$STATION

DELE ALL FOR "CDOT IN"$STATION 
*appe from OCHhst for date>=d1.and.date<=d2.AND."21"$TIME.AND.("II M.P. "$LEVEL.OR."PRNTD"$LEVEL.OR."L "$LEVEL)
*dele all for "II M.P. "#LEVEL.OR."PRNTD"#LEVEL.OR."L "#LEVEL
BROW
PACK

set uniq on
index on station to A1
COPY TO WCCR1

SET UNIQ OFF
USE WCCR1
BROW FOR STATION=SPACE(18)
DELE ALL FOR STATION=SPACE(18)
*DELE ALL FOR FE=0.OR.FP=0
PACK
SORT ON STATION TO B1
ZAP
APPE FROM B1
USE WCCR
ZAP
APPE FROM WCCR1
USE
SELE 1
USE WCCR
SELE 2
USE MS2
SORT ON DATE TO C1
ZAP
APPE FROM C1
SELE 1
GO TOP
DO WHILE.NOT.EOF()
A=STATION

SELE 2
SUM FE FOR "O"$SUBSTR(NFSC,1,1).AND.STATION=A TO S1
SUM FP FOR "O"$SUBSTR(NFSC,1,1).AND.STATION=A TO S2
SUM FE FOR "I"$SUBSTR(NFSC,1,1).AND.STATION=A TO S3
SUM FP FOR "I"$SUBSTR(NFSC,1,1).AND.STATION=A TO S4


SELE 1
REPL FE_O WITH S1
REPL FP_O WITH S2
*REPL FE_I WITH S3
*REPL FP_I WITH S4

*IF (S1#0  .AND. S2#0) .OR. (S3#0 .AND. S4#0)
*IF S1#0 .AND. S2#0 .OR. S3#0 .OR. S4#0
IF S1#0 .AND. S2#0
REPL AVCCR_OG WITH S1*100/S2 
ENDIF
IF S3#0 .AND. S4#0
REPL AVCCR_IC WITH S3*100/S4 

ENDIF
SKIP
ENDDO
CLOS ALL
********
SELE 1
USE WCCR
SELE 2
USE MS2

SELE 1
GO TOP
DO WHILE.NOT.EOF()
A=STATION
SELE 2
K=1
DO WHILE K<=1

X=RECNO()
D=DATE
SUM FE TO S5 FOR DATE=D.AND."O"$SUBSTR(NFSC,1,1).AND.STATION=A
SUM FP TO S6 FOR DATE=D.AND."O"$SUBSTR(NFSC,1,1).AND.STATION=A
SUM FO TO S7 FOR DATE=D.AND."O"$SUBSTR(NFSC,1,1).AND.STATION=A
SUM FO TO S8 FOR DATE=D.AND."I"$SUBSTR(NFSC,1,1).AND.STATION=A
SUM FE TO S9 FOR DATE=D.AND."I"$SUBSTR(NFSC,1,1).AND.STATION=A
SUM FP TO S10 FOR DATE=D.AND."I"$SUBSTR(NFSC,1,1).AND.STATION=A
C1="FED"+ALLTRIM(STR(K))
C2="FPD"+ALLTRIM(STR(K))
C3="CCR_OG"+ALLTRIM(STR(K))
C4="TFC_OG"+ALLTRIM(STR(K))
C5="CCR_IC"+ALLTRIM(STR(K))
C6="TFC_IC"+ALLTRIM(STR(K))

RG1="FEI"+ALLTRIM(STR(K))
RG2="FPI"+ALLTRIM(STR(K))


GOTO X
SELE 1
REPL &C1 WITH S5
REPL &C2 WITH S6
REPL &C4 WITH S7
REPL &C6 WITH S8

REPL &RG1 WITH S9
REPL &RG2 WITH S10


IF S5#0.AND.S6#0.AND.S9#0.AND.S10#0
REPL &C3 WITH S5*100/S6
REPL &C5 WITH S9*100/S10
ENDIF

SELE 2
DO WHIL DATE=D
SKIP
ENDDO
K=K+1
ENDDO
GO TOP

SELE 1
SKIP
ENDDO
SET SAFE ON
SET TALK ON
CLOS ALL

SELE 1
USE MS2
SELE 2
USE WCCR

SELE 1
SUM FR FOR "T01"$NFSC TO T1
SUM FR FOR "T06"$NFSC TO T6
SELE 2
REPL AVCCR_OG WITH T1*100/T6 FOR "BPLCITY "$STATION
USE WCCRIIOMP 
ZAP
USE WCCRI
ZAP
CLOSE ALL
USE WCCR
COPY TO WCCRI FOR "I      "$LEVEL
COPY TO WCCRIIMP FOR "II M.P."$LEVEL
USE WCCRIIMP
*APPEND FROM WCCR FOR "ALCATEL MSC"$STATION
*APPEND FROM WCCR FOR "ARERA"$STATION .OR. "BSNL MOBILE"$STATION .OR. "BSNL WLL"$STATION
*APPEND FROM WCCR FOR "CITY ALCATEL"$STATION
*APPEND FROM WCCR FOR "JABALPUR MSC"$STATION
APPEND FROM WCCR FOR "MSC BSNL"$LEVEL
REPLACE ALL STATION WITH "LUCENT MSC" FOR "BSNL MOBILE"$STATION
DELE ALL FOR "BALAGHAT ISD"$STATION .OR. "BHIND"$STATION .OR. "MANDLA ISD"$STATION .OR. "SINGROLI"$STATION
PACK  
CLOSE ALL
USE WCCRIIOMP
ZAP
USE WCCRSSA
ZAP
USE WCCRPRV
ZAP
USE WCCRMSC
ZAP
CLOSE ALL

USE WCCR
COPY TO WCCRIIOMP FOR "II OM.P."$LEVEL
COPY TO WCCRSSA FOR "SSA BPL"$LEVEL
COPY TO WCCRPRV FOR "PRIVATE"$LEVEL
COPY TO WCCRMSC FOR "MSC BSNL"$LEVEL
USE WCCRIIMP
APPEND FROM WCCR FOR "BHOPALSSA"$STATION
*APPEND FROM WCCRMSC FOR "MSC BSNL"$STATION
SORT ON AVCCR_OG TO AV
ZAP
APPE FROM AV
APPEND FROM WCCR FOR "BPLCITY"$STATION

CLOS ALL




