clea
CLOS ALL
SET SAFE OFF
SET TALK OFF
d1="07-02-19"
d2="07-02-25"
@5,13 say "enter from date" get d1
@7,13 say "enter  to  date" get d2
read
d3=subtr(d2,7,2)
d4=val(d3)+1
use ms2
zap

appe from D:\XTALK\ABC\OCHHST for date>=d1.and.date<=d2.AND."21"$TIME.AND.("I"$LEVEL.OR."PRNTD"$LEVEL.OR."L "$LEVEL)

*appe from D:\XTALK\ABC\MAY05D for date>=d1.and.date<=d2.AND."21"$TIME
REPL ALL STATION WITH "BPLCITY " FOR "T01"$NFSC
REPL ALL STATION WITH "BPLCITY " FOR "T06"$NFSC
REPL ALL STATION WITH "BHOPALSSA " FOR "PRNTD"$LEVEL

REPL ALL STATION WITH "INDORE" FOR "INDORE"$STATION
REPL ALL STATION WITH "GWALIOR" FOR "GWALIOR"$STATION
REPL ALL STATION WITH "CHINDWARA" FOR "CHINDWARA"$STATION
REPL ALL STATION WITH "GUNA" FOR "GUNA"$STATION
REPL ALL STATION WITH "ITARSI" FOR "ITAR"$STATION
REPL ALL STATION WITH "MANDSAUR" FOR "MANDSAUR"$STATION
REPL ALL STATION WITH "RATLAM" FOR "RATLAM"$STATION
REPL ALL STATION WITH "NARSINGHPUR" FOR "NARSINGHPUR"$STATION
REPL ALL STATION WITH "SHAJAPUR" FOR "SHAJAPUR"$STATION

REPL ALL STATION WITH "BETUL" FOR "BETUL"$STATION
REPL ALL STATION WITH "CHHATARPUR" FOR "CHHATARPUR"$STATION
REPL ALL STATION WITH "DAMOH" FOR "DAMOH"$STATION
REPL ALL STATION WITH "DHAR" FOR "DHAR"$SUBSTR(STATION,1,4)
REPL ALL STATION WITH "JABALPUR" FOR "JABALPUR"$STATION
REPL ALL STATION WITH "JHABUA" FOR "JHABUA"$STATION
REPL ALL STATION WITH "KHANDWA" FOR "KHANDWA"$STATION
REPL ALL STATION WITH "KHARGONE" FOR "KHARGONE"$STATION
REPL ALL STATION WITH "MORENA" FOR "MORENA"$STATION


REPL ALL STATION WITH "PANNA" FOR "PANNA"$STATION
REPL ALL STATION WITH "RAISEN" FOR "RAISEN"$STATION
REPL ALL STATION WITH "SAGAR" FOR "SAGAR"$STATION
REPL ALL STATION WITH "SATNA" FOR "SATNA"$STATION
REPL ALL STATION WITH "SEONI" FOR "SEONI"$STATION
REPL ALL STATION WITH "SHAHDOL" FOR "SHAHDOL"$STATION
REPL ALL STATION WITH "SHIVPURI" FOR "SHIVPURI"$STATION
REPL ALL STATION WITH "SIDHI" FOR "SIDHI"$STATION
REPL ALL STATION WITH "UJJAIN" FOR "UJJAIN"$STATION


REPL ALL STATION WITH "VIDISHA" FOR "VIDISHA"$STATION
REPL ALL STATION WITH "ATX E10B" FOR "ATX E10B"$STATION
REPL ALL STATION WITH "OCB LOCAL" FOR "OCB LOCAL"$STATION
REPL ALL STATION WITH "CTX E10B" FOR "CTX"$STATION
REPL ALL STATION WITH "SEONI" FOR "SEONI"$STATION
 
REPL ALL STATION WITH "RIL WLL" FOR "RIL WLL"$STATION
REPL ALL STATION WITH "RIL W/LINE" FOR "RIL W/LINE"$STATION
REPL ALL STATION WITH "BTNL" FOR "BHARTHI"$STATION
REPL ALL STATION WITH "RPG" FOR "RPG"$STATION

DELE ALL FOR "CDOT IN"$STATION 
*appe from OCHhst for date>=d1.and.date<=d2.AND."21"$TIME.AND.("II M.P. "$LEVEL.OR."PRNTD"$LEVEL.OR."L "$LEVEL)
*dele all for "II M.P. "#LEVEL.OR."PRNTD"#LEVEL.OR."L "#LEVEL
BROW
*PACK
set uniq on
index on station to q1
COPY TO WCCR1
SET UNIQ OFF
USE WCCR1
BROW FOR STATION=SPACE(18)
DELE ALL FOR STATION=SPACE(18)
*DELE ALL FOR FE=0.OR.FP=0
PACK
SORT ON STATION TO Q1
ZAP
APPE FROM Q1
USE WCCR
ZAP
APPE FROM WCCR1
USE
SELE 1
USE WCCR
SELE 2
USE MS2
SORT ON DATE TO Q1
ZAP
APPE FROM Q1
SELE 1
GO TOP
DO WHILE.NOT.EOF()
A=STATION

SELE 2
SUM FE FOR "O"$SUBSTR(NFSC,1,1).AND.STATION=A TO S1
SUM FP FOR "O"$SUBSTR(NFSC,1,1).AND.STATION=A TO S2
SUM FE FOR "I"$SUBSTR(NFSC,1,1).AND.STATION=A TO S3
SUM FP FOR "I"$SUBSTR(NFSC,1,1).AND.STATION=A TO S4


SELE 1
IF S1#0.AND.S2#0.AND.S3#0.AND.S4#0
*IF S1#0.AND.S2#0.OR.S3#0.OR.S4#0
REPL AVCCR_OG WITH S1*100/S2 
REPL AVCCR_IC WITH S3*100/S4 
ENDIF
SKIP
ENDDO
CLOS ALL
********
SELE 1
USE WCCR
SELE 2
USE MS2

SELE 1
GO TOP


DO WHILE.NOT.EOF()
A=STATION
SELE 2
K=1
DO WHILE K<=30
X=RECNO()
D=DATE
SUM FE TO S5 FOR DATE=D.AND."O"$SUBSTR(NFSC,1,1).AND.STATION=A
SUM FP TO S6 FOR DATE=D.AND."O"$SUBSTR(NFSC,1,1).AND.STATION=A
SUM FO TO S7 FOR DATE=D.AND."O"$SUBSTR(NFSC,1,1).AND.STATION=A
SUM FO TO S8 FOR DATE=D.AND."I"$SUBSTR(NFSC,1,1).AND.STATION=A
SUM FE TO S9 FOR DATE=D.AND."I"$SUBSTR(NFSC,1,1).AND.STATION=A
SUM FP TO S10 FOR DATE=D.AND."I"$SUBSTR(NFSC,1,1).AND.STATION=A
C1="FED"+ALLTRIM(STR(K))
C2="FPD"+ALLTRIM(STR(K))
C3="CCR_OG"+ALLTRIM(STR(K))
C4="TFC_OG"+ALLTRIM(STR(K))
C5="CCR_IC"+ALLTRIM(STR(K))
C6="TFC_IC"+ALLTRIM(STR(K))
GOTO X
SELE 1
REPL &C1 WITH S5
REPL &C2 WITH S6
REPL &C4 WITH S7
REPL &C6 WITH S8
IF S5#0.AND.S6#0.AND.S9#0.AND.S10#0
REPL &C3 WITH S5*100/S6
REPL &C5 WITH S9*100/S10
ENDIF

SELE 2
DO WHIL DATE=D
SKIP
ENDDO
K=K+1
ENDDO
GO TOP

SELE 1
SKIP
ENDDO
SET SAFE ON
SET TALK ON
CLOS ALL

SELE 1
USE MS2
SELE 2
USE WCCR

SELE 1
SUM FR FOR "T01"$NFSC TO T1
SUM FR FOR "T06"$NFSC TO T6
SELE 2
REPL AVCCR_OG WITH T1*100/T6 FOR "BPLCITY "$STATION

USE WCCR
COPY TO WCCRI FOR "I      "$LEVEL
COPY TO WCCRIIMP FOR "II M.P."$LEVEL
COPY TO WCCRIIOMP FOR "II OMP"$LEVEL
COPY TO WCCRPN FOR "PRNTD"$LEVEL
COPY TO WCCRPRV FOR "PRIVATE"$LEVEL
USE WCCRIIMP
APPEND FROM WCCRPN
SORT ON AVCCR_OG TO AV
ZAP
APPE FROM AV
APPEND FROM WCCR FOR "BPLCITY"$STATION
CLOS ALL



